<script>
    var datagett = []
    var picprofile =  ""
    
    function getpic(){
      var dataget;
        var urljson = "https://script.googleusercontent.com/macros/echo?user_content_key=YqyDZdxWEJS-1VD3HmJyFI9BvM0A5G0iphXgnOTUPULhWNs15odVCFd5sYNaDSHk2eRS8CMAEH7Dz4211F5C_if3ieXETnZMm5_BxDlH2jW0nuo2oDemN9CCS2h10ox_1xSncGQajx_ryfhECjZEnESenDeG1a2U5A9HgblmFIqgY1h708_S0WEz0UAVMSP1MOyWK_cu-E6ACoz3t86BEnltYe52Wkzn&lib=Mih9OC5pj5Vkn2Axmh0oYykMWxYDvAMv8";
        $.getJSON(urljson, function (data) {
            dataget = data.user
            console.log(dataget[1].Picture)
            var imgECS2 = ""
            const toDataURL = url => fetch(url)
          .then(response => response.blob())
          .then(blob => new Promise((resolve, reject) => {
            const reader = new FileReader()
            reader.onloadend = () => resolve(reader.result)
            reader.onerror = reject
            reader.readAsDataURL(blob)
          }))
          console.log(dataget[1].Picture)
          splitpath = (dataget[1].Picture).split("\\");
          
          picprofile  = 'uploads/'+ splitpath[2]
        toDataURL(picprofile )
          .then(dataUrl => {
            imgECS2 = dataUrl
            
          })
          encodeim()
        });

    }


      var  imgECS = ""
      function encodeim(){
           const toDataURL = url => fetch(url)
          .then(response => response.blob())
          .then(blob => new Promise((resolve, reject) => {
            const reader = new FileReader()
            reader.onloadend = () => resolve(reader.result)
            reader.onerror = reject
            reader.readAsDataURL(blob)
          }))


        toDataURL('img/ECS.jpg')
          .then(dataUrl => {
            imgECS = dataUrl
            loadpdf()
          })
        }



        function loadpdf(){
          var doc = new jsPDF()
          // console.log()
          doc.setFontSize(12)
          ecs = "Enterprice Computing Services (Thailand) Co ,.Ltd."
          address = "333 Lao Peng Nguan Tower 1,16th Floor,"
          address2 = "Soi Choei phuang,Vibhavadee-Rangsit Rd.,"
          address3 = "Chomphon,Chatuchak, Bangkok 10900(Thailand)"
          address4 = ""
          tel = "Tel : (662)880-9494,880-9344,880-9003"
          fax = "Fax : (662880-9344)"
          web = "Web site : https:www.ecs.co.th"
          doc.setFontType('bold')
          doc.text(ecs, 100, 15);
          doc.setFontType('default')
          doc.text(address, 100, 20);
          doc.text(address2, 100, 25);
          doc.text(address3, 100, 30);
          // doc.text(address4, 100, 40);
          doc.text(tel, 100, 35);
          doc.text(fax, 100, 40);
          doc.text(web, 100, 45);
          doc.line(10,55,200,55)
          doc.addImage(imgECS,'JPG',10,10,40.640625,32.54375)
          doc.setFontType('bold')
          doc.text("APPLICATION FOR EMPLOYMEN",70,65)
          // doc.setFontType('default')
          // doc.text("Date : 08 - 02 - 2019",150,75)
          doc.addImage(imgECS2,'JPG',155,70,38.1,50.8)
          doc.setFontType('bold')
          doc.text("Application",10,95)
          doc.setFontType('default')
          doc.text("    Position to apply : Developer",10,105)
          doc.text("    Expected Compensation : 99,999,999",10,110)
          doc.setFontType('bold')
          doc.text("Personal Data",10,120)
          doc.setFontType('default')
          doc.text("    Name : "+ dataget[1].Title_Name + dataget[1].First_Name +  " Last : " + dataget[1].Last_Name,10,130)
          doc.text("    Nickname : ",90,130)
          doc.text("    Age : " + dataget[1].Age,130,130)
          doc.text("    Weight : " + dataget[1].Weight + " kg.",10,135)
          doc.text("    Height : " + dataget[1].Height + " cm.",50,135)
          doc.text("    Address from above : " + dataget[1].Address_in_ID_Card,10,140)
          doc.text("    Present Address : "+ dataget[1].Current_Address,10,145)
          doc.text("    Telephone number : 0"+ dataget[1].Telephone_Number,10,150)
          doc.text("    E-mail : "+ dataget[1].Email_Address,80,150)
          doc.setFontType('bold')
          doc.text("Educational Background",10,160)
          doc.setFontType('default')
          doc.text("    Higher Education Level",10,170)
          doc.text("    Degree : "+ dataget[1].Degree,10,175)
          doc.text("    Institue : "+ dataget[1].Faculty + " of " + dataget[1].Educational_institution_u,10,180)
          doc.text("    GPA : "+ dataget[1].GPA_u,10,185)
          doc.text("    Date of graduation : "+ dataget[1].Graduation_day_u,10,190)
          doc.text("    Upper Secondary Level",10,200)
          doc.text("    Degree : "+ dataget[1].Type,10,205)
          doc.text("    Institue : "+ dataget[1].Course + " of " + dataget[1].Educational_institution_s,10,210)
          doc.text("    GPA : "+ dataget[1].GPA_s,10,215)
          doc.text("    Date of graduation : "+ dataget[1].Study_start_date_s,10,220)
          doc.setFontType('bold')
          doc.text("Computer Skill",10,230)
          doc.setFontType('default')
          doc.text("    Programing Language : ",10,240)
          doc.text("    Tool for development : ",110,240)
          doc.text("    Database : ",10,245)
          doc.text("    Operating System : ",110,245)
          doc.setFontType('bold')
          doc.text("Work Experience",10,255)
          doc.setFontType('default')
          doc.text("    Organization : ",10,265)
          doc.text("    Working position : ",90,265)
          doc.text("    Salary : 20,000",170,265)
          doc.text("    Start work date : 08 - 02 - 2019",10,270)
          doc.text("    Date of departure 08 - 02 - 2019",110,270)
          doc.text("    Describe yourself : ",10,275)
          doc.text("    Responsibilities : ",10,280)
          doc.text("Date : 08 - 02 - 2019",165,290)
          doc.save('a4.pdf')
          }
</script>