<html>
<head>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Lora" rel="stylesheet">
    <link rel="stylesheet" href="edit.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script>

    // var script_url = "https://script.google.com/macros/s/AKfycbyGmexktWuU1R9bjIYZL6EUvcuV0EBErhPIwlOJt5c7RwBSyQ/exec";
    // var script_url ="https://script.google.com/macros/s/AKfycbz3ubfjK8ULp9G7MqdxWdLCJqyh4uPIgm-ijVJWxToMe1OUgro/exec";
    var script_url ="https://script.google.com/macros/s/AKfycbytiV42RbmsesNrHEFS8VGONExFfKZbmva6FH-UdnX7sdzE3g6-/exec";

    
    console.log(script_url);

    // Make an AJAX call to Google Script
    function insert_value() {

      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";
      $('#mySpinner').addClass('spinner');

      var id1 = $("#id").val();
      var tn =$("#tn").val();
      var name = $("#name").val();
      var lname =$("#lname").val();
      var dob =$("#dob").val();
      var tel =$("#tel").val();
      var fb =$("#fb").val();
      var line =$("#line").val();
      var ig =$("#ig").val();
      var aic =$("#aic").val();
      var ca =$("#ca").val();
      var ei =$("#ei").val();
      var gpa =$("#gpa").val();
      var sp =$("#sp").val();
      var tfp =$("#tfp").val();
      var spack =$("#spack").val();
      var mail =$("#mail").val();
      
      // var sum = $("#id").val(); + $("#name").val(); + $("#lname").val();
      console.log($("#id").val());
      console.log($("#name").val());
      console.log($("#lname").val());


      // var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&lname=" + lname +"&action=insert";
      // var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&action=insert";
      var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&lname=" + lname + "&tn="+ tn + "&dob=" + dob + "&tel=" + tel + "&fb=" + fb + "&line=" + line + "&ig=" + ig + "&aic=" + aic + "&ca="+ ca + "&ei="+ ei + "&gpa="+ gpa + "&sp="+ sp + "&tfp=" + tfp +"&spack="+ spack +"&mail="+ mail +"&action=insert";
      console.log(url);


      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });

    }

    function update_value() {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";
      var id1 = $("#id").val();
      var tn =$("#tn").val();
      var name = $("#name").val();
      var lname =$("#lname").val();
      var dob =$("#dob").val();
      var tel =$("#tel").val();
      var fb =$("#fb").val();
      var line =$("#line").val();
      var ig =$("#ig").val();
      var aic =$("#aic").val();
      var ca =$("#ca").val();
      var ei =$("#ei").val();
      var gpa =$("#gpa").val();
      var sp =$("#sp").val();
      var tfp =$("#tfp").val();
      var spack =$("#spack").val();
      var mail =$("#mail").val();
      var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&lname=" + lname + "&tn="+ tn + "&dob=" + dob + "&tel=" + tel + "&fb=" + fb + "&line=" + line + "&ig=" + ig + "&aic=" + aic + "&ca="+ ca + "&ei="+ ei + "&gpa="+ gpa + "&sp="+ sp + "&tfp=" + tfp +"&spack="+ spack +"&mail="+ mail +"&action=update";
      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });
      console.log($("#id").val());
      console.log($("#name").val());
      console.log($("#lname").val());


    }
    function delete_value() {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";
      $('#mySpinner').addClass('spinner');
      var id1 = $("#id").val();
      var tn =$("#tn").val();
      var name = $("#name").val();
      var lname =$("#lname").val();
      var dob =$("#dob").val();
      var tel =$("#tel").val();
      var fb =$("#fb").val();
      var line =$("#line").val();
      var ig =$("#ig").val();
      var aic =$("#aic").val();
      var ca =$("#ca").val();
      var ei =$("#ei").val();
      var gpa =$("#gpa").val();
      var sp =$("#sp").val();
      var tfp =$("#tfp").val();
      var spack =$("#spack").val();
      var mail =$("#mail").val();
      var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&lname=" + lname + "&tn="+ tn + "&dob=" + dob + "&tel=" + tel + "&fb=" + fb + "&line=" + line + "&ig=" + ig + "&aic=" + aic + "&ca="+ ca + "&ei="+ ei + "&gpa="+ gpa + "&sp="+ sp + "&tfp=" + tfp +"&spack="+ spack +"&mail="+ mail +"&action=delete";
      var sss = "https://docs.google.com/spreadsheets/d/1duiJZGrAchzeMIbKzbsa5pM8T2-lkfbJJtZtTE5evTk/edit?usp=sharing";
      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });

    }
    // print the returned data
    function ctrlq(e) {
      $("#re").html(e.result);
      $("#re").css("visibility", "visible");
      read_value();

    }
    function read_value() {

      $("#re").css("visibility", "hidden");

      document.getElementById("loader").style.visibility = "visible";
      var url = script_url + "?action=read";

      $.getJSON(url, function (json) {

        // Set the variables from the results array
        // CREATE DYNAMIC TABLE.
        var table = document.createElement("table");
        var header = table.createTHead();
        var row = header.insertRow(0);
        // for(var k =0;k<16;k++){

        // }
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        var cell9 = row.insertCell(8);
        var cell10 = row.insertCell(9);
        var cell11 = row.insertCell(10);
        var cell12 = row.insertCell(11);
        var cell13 = row.insertCell(12);
        var cell14 = row.insertCell(13);
        var cell15 = row.insertCell(14);
        var cell16 = row.insertCell(15);
        var cell17 = row.insertCell(16);

        cell1.innerHTML = "<b>ID</b>";
        cell2.innerHTML = "<b>Title_Name</b>";
        cell3.innerHTML = "<b>First_Name</b>";
        cell4.innerHTML = "<b>Last_Name</b>";
        cell5.innerHTML = "<b>Date_of_birth</b>";
        cell6.innerHTML = "<b>Telephone_Number</b>";
        cell7.innerHTML = "<b>Facebook</b>";
        cell8.innerHTML = "<b>Line</b>";
        cell9.innerHTML = "<b>Instagram</b>";
        cell10.innerHTML = "<b>Address_in_ID_Card</b>";
        cell11.innerHTML = "<b>Current_Address</b>";
        cell12.innerHTML = "<b>Educational_institution</b>";
        cell13.innerHTML = "<b>GPAX</b>";
        cell14.innerHTML = "<b>Skill_programming</b>";
        cell15.innerHTML = "<b>Tool_for_development</b>";
        cell16.innerHTML = "<b>Software_Package</b>";
        cell17.innerHTML = "<b>Email_Address</b>";

        // ADD JSON DATA TO THE TABLE AS ROWS.
        for (var i = 0; i < json.records.length; i++) {

          tr = table.insertRow(-1);
          var tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].ID;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Title_Name;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].First_Name;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Last_Name;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Date_of_birth;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Telephone_Number;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Facebook;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Line;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Instagram;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Address_in_ID_Card;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Current_Address;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Educational_institution;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].GPAX;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Skill_programming;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Tool_for_development;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Software_Package;
          tabCell = tr.insertCell(-1);
          tabCell.innerHTML = json.records[i].Email_Address;



          // console.log(json.records[i].LNAME);

        }
        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
        var divContainer = document.getElementById("showData");
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
        document.getElementById("loader").style.visibility = "hidden";
        $("#re").css("visibility", "visible");
      });
    }

  </script>

</head>

<body bgcolor="#9400d3">
  <div align="center">
    <h1><i><strong style="color:white">Application form for register</strong></i></h1>
    <p style="color:white">This is simple application<p>

      <div class="container-bg" align="left">
        <form>
        <label>ID :</label>   
          <input type="text" name="id" id="id" placeholder=" 1-100 Etc." required><br>
          <label>Title Name : </label>
          <select name="tn" id="tn" required>
            <option value="Mr.">Mr.</option>
            <option value="Ms.">Ms.</option>
            <option value="Mrs.">Mrs.</option>
          </select><br>
          <label>First Name : </label>
          <input type="text" name="name" id="name" placeholder="Enter your first name" required><br>
          <label>Last Name : </label>
          <input type="text" name="lname" id="lname" placeholder="Enter your last name" required><br>
          <label>Date of birth : </label>
          <input type="date" name="dob" id="dob" max="2100-12-31"><br>
          <label>Telephone Number : </label>
          <input type="tel" name="tel" id="tel" placeholder="0213456789" required><br>
          <label>Facebook : </label>
          <input type="text" name="fb" id="fb" placeholder="Enter your facebook name" ><br>
          <label>Line : </label>
          <input type="text" name="line" id="line" placeholder="Enter your id line" ><br>
          <label>Instagram : </label>
          <input type="text" name="ig" id="ig" placeholder="Enter your Instagram" ><br>
          <label>Email Address : </label>
          <input type="email" name="mail" id="mail" placeholder="Enter E-mail  address" required><br>
          <label>Address in ID Card : </label>
          <input type="text" name="aic" id="aic" placeholder="Enter your address" ><br>
          <label>Current Address : </label>
          <input type="text" name="ca" id="ca" placeholder="Enter your address" required><br>
          <label>Educational institution : </label>
          <input type="text" name="ei" id="ei" placeholder="Enter your first educational" ><br>
          <label>GPAX : </label>
          <input type="text" name="gpa" id="gpa" placeholder="Enter GPA" ><br>
          <label>Skill programming : </label>
          <input type="text" name="sp" id="sp" placeholder="Hardware development Etc." required><br>
          <label>Tool for development : </label>
          <input type="text" name="tfp" id="tfp" placeholder="Vscode Etc." required><br>
          <label>Software Package : </label>
          <input type="text" name="spack" id="spack" placeholder="ORACLE Etc." required>

          <div class="container-fluid" align="center">
              <div id="loader"></div>
              <!-- <p id="re"></p> -->
          <input type="submit" id="b1" onClick="insert_value()" value="Insert"></input>
          <input type="button" id="b1" onclick="read_value()" value="Read"></input>
          <input type="submit" id="b1" onclick="update_value()" value="Update"></input>
          <input type="button" id="b1" onclick="delete_value()" value="Delete"></input>
          </div>
        </div>
        </form>







        <!-- <a href="https://docs.google.com/spreadsheets/d/1duiJZGrAchzeMIbKzbsa5pM8T2-lkfbJJtZtTE5evTk/edit?usp=sharing"
          target="_blank">Click here to open Spread Sheet </a> -->
        
          <!-- this for show data in ss after insert or click read -->
        <div id="showData"></div>
  </div>
</body>
<div align="center">
  <p style="color:white">Enterprise Computing Services Co., Ltd.</p>
</div>

</html>